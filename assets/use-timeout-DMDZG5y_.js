import{e as L,K as w,p as c,z as s,B as E,ae as S,o as P,g as q}from"./index-BwSGB-g4.js";import{q as H,r as C,t as x}from"./format-ClS5xHc8.js";import{v as V}from"./QBtn-I20VTzYT.js";function B(e,t,r){let o;function l(){o!==void 0&&(w.remove(o),o=void 0)}return L(()=>{e.value===!0&&l()}),{removeFromHistory:l,addToHistory(){o={condition:()=>r.value===!0,handler:t},w.add(o)}}}let a=0,v,p,d,m=!1,h,y,g,n=null;function z(e){W(e)&&E(e)}function W(e){if(e.target===document.body||e.target.classList.contains("q-layout__backdrop"))return!0;const t=S(e),r=e.shiftKey&&!e.deltaX,o=!r&&Math.abs(e.deltaX)<=Math.abs(e.deltaY),l=r||o?e.deltaY:e.deltaX;for(let f=0;f<t.length;f++){const i=t[f];if(x(i,o))return o?l<0&&i.scrollTop===0?!0:l>0&&i.scrollTop+i.clientHeight===i.scrollHeight:l<0&&i.scrollLeft===0?!0:l>0&&i.scrollLeft+i.clientWidth===i.scrollWidth}return!0}function T(e){e.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function u(e){m!==!0&&(m=!0,requestAnimationFrame(()=>{m=!1;const{height:t}=e.target,{clientHeight:r,scrollTop:o}=document.scrollingElement;(d===void 0||t!==window.innerHeight)&&(d=r-t,document.scrollingElement.scrollTop=o),o>d&&(document.scrollingElement.scrollTop-=Math.ceil((o-d)/8))}))}function b(e){const t=document.body,r=window.visualViewport!==void 0;if(e==="add"){const{overflowY:o,overflowX:l}=window.getComputedStyle(t);v=H(window),p=C(window),h=t.style.left,y=t.style.top,g=window.location.href,t.style.left=`-${v}px`,t.style.top=`-${p}px`,l!=="hidden"&&(l==="scroll"||t.scrollWidth>window.innerWidth)&&t.classList.add("q-body--force-scrollbar-x"),o!=="hidden"&&(o==="scroll"||t.scrollHeight>window.innerHeight)&&t.classList.add("q-body--force-scrollbar-y"),t.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,c.is.ios===!0&&(r===!0?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",u,s.passiveCapture),window.visualViewport.addEventListener("scroll",u,s.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",T,s.passiveCapture))}c.is.desktop===!0&&c.is.mac===!0&&window[`${e}EventListener`]("wheel",z,s.notPassive),e==="remove"&&(c.is.ios===!0&&(r===!0?(window.visualViewport.removeEventListener("resize",u,s.passiveCapture),window.visualViewport.removeEventListener("scroll",u,s.passiveCapture)):window.removeEventListener("scroll",T,s.passiveCapture)),t.classList.remove("q-body--prevent-scroll"),t.classList.remove("q-body--force-scrollbar-x"),t.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,t.style.left=h,t.style.top=y,window.location.href===g&&window.scrollTo(v,p),d=void 0)}function X(e){let t="add";if(e===!0){if(a++,n!==null){clearTimeout(n),n=null;return}if(a>1)return}else{if(a===0||(a--,a>0))return;if(t="remove",c.is.ios===!0&&c.is.nativeMobile===!0){n!==null&&clearTimeout(n),n=setTimeout(()=>{b(t),n=null},100);return}}b(t)}function $(){let e;return{preventBodyScroll(t){t!==e&&(e!==void 0||t===!0)&&(e=t,X(t))}}}function k(){let e=null;const t=q();function r(){e!==null&&(clearTimeout(e),e=null)}return P(r),L(r),{removeTimeout:r,registerTimeout(o,l){r(),V(t)===!1&&(e=setTimeout(()=>{e=null,o()},l))}}}export{B as a,$ as b,k as u};
